var AutoSuggest;(function(n){var t;(function(t){function c(n){return n.toLocaleLowerCase().replace(a,"").trim()}function o(n,t,i,r,u){if(!n)return i;if(typeof n!="string")try{return{content:URL.createObjectURL(n),type:0,bgColor:r}}catch(f){return SharedLogHelper.LogError("convertToHtmlImage "+t,u,f),i}else return{content:n,type:0,bgColor:r}}var l="data:img/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAR4UlEQVR4nMVbe4wd5XX/nW/m7nr9XNtpMSqpAZOShLbQ8gpgIFHU/EOSmiJASaWqqqmCUpqakMoxCKEopXbVQoiEqigyJFFaEVInMcSkokqa3YQIh9CAIAZMvH6AIfiBd+193cfMd6pzvsfM3Hv3Za/Jt5qd973f+Z1zfucxc4mZcTrHRT95cwPA6xj2fMAuY7J9gHynLBagYk1kZTsjsmMEux/A/sRk33r28ksfPV1TnHcALh58ezXD3s2w1zHsqiAge6EZeUloiwiG3xYQyK/lmJF9skzIDyVJ9gSR/eLTf3rtgfma77wBcMng8Q2AvY1h17AKbMFRQL8vwuu3OkAoAFECQPaJisUBINfmMCaHoQzG2CFD+YM/vfDPHjjVeZ8yAJcOnhATv4fB/U7DNi6iaV0jrxwL11UFd0IShe1i3+jaIk1aCgApEBbGZJOGsi//7wV/vukdB+CywfHVAP9INO4ECkI5TTMhah5toBTHg/kHSwjaLtZyPjEOAGNaCoazhNwBYjLZHjEm/8KT5980Z4s4KQAuH5zYDPBGVjHZ+7fVvwCA0z6XTF9cojD5CgDeEqjMAwUpismrxhMBwAufmKazDiPbme4nJnu+ltTXbT/3lllzhJmr8B8YnNwD8OcBJopHOZKcDFIa84QXyY8BLm2XRrzbH3Zrt6Mc4IG1alYMZoLlJF5P3kWI8ouY8fIN+//95tnKM2sLuGKwIez+MsB9ZYFt1KjXNuV+P2tzi3AObVYQZ+K0HTnAk6CxjgBVyFzdwWk8U5dIKEOSNPW4uIPbb7Ch7OFtqz9zy0xyzcoCrhhs3AzwywD6RL9uQZsmC0JzglHB8GEpabZynwdJoeFIif4zuHJPcBOxAmajQou9KTlCeKEOA0upaa3/xMF/23rKAFw52FxLwCMifBAb7YJ382kvEHWYfLfry+eip+jaWgNPNe6cNSq4g0jcwjjyRK4cAe8Scq+hbP1f/eaL04IwLQBXDjaF6f/HqYK7TL4QqEQIJQCm03bBB/rHiJYVrvVwwNrEG0+wjdzzAivAeg0bBcva8mfoNev/+tDdU4IwkwV4s68KQtE0rZsycYf2uSSgO5bHu6diHQ48KeKxn1okPuOcwmeIFKOGm4OLDJnLI5jVGsQSfIq9/pYjGzfMCYCrBpt7HOF1mWhXzZaX8nWe6Ig7gOI2K6oCTV54lPgD6vsycnUF5xIxMoileFJ3CVTmuUGTsfs/dfT21bMC4KqB1maA1lDFJMtTo7hVYfIoDKpCik9W3KI7YPETuPwJ7rvUxL2Zs03cUSbNA9CWVovQbF34ZMsg1vqCQPb5GQFYO5CtJtDG9nkVQpdPWD/hdqFt6T4fIPx5LoXNmYaYfWB7+P0yQOpqPrKI7xtqxuOOCMlpX2uKFgyy/k8f+9TmilztecDagWwPgDVMZTMtr51/Z40mJt4eQXN8DBNvvK4SkrdaDUu9Peh5Vz9qyxciXVKD6Snf3241nSOQasgBRKsu/rcqi4Q9yQJ70kmkSVMFTZMGUtN0eYJe04ruYKiVGWPPe3D5Q5otpuVvvnogE6JYEwyvXUf18TqG9+7F6J7daI6NwqQ9QJqCjCxGZ03kZ8/jmDh4BLA5kDeRLlmAvjXvRt/ZK5F0ZZaSVoLZeJ+X2biEKAAXqkYVyKXFyJDnBiYNlgY9JyYiboAkEnTKlr8B4IMdFnD1QD4McD97mw0hanxkFIee+wXGDh4E9fSB0hooqQGJAZGRb3IMbUxJAEd85JgKxBk4a4GbE1hw5gosuvBs1JZMHYTCZ3it6X5iGrovGhWhU1NXC6ilDSTUUAuQa8I60dI5Kwonv0/Ipb9wzoMrv3kgWsA1A7mUtf0IuTwzWo0WDj77LI4f2AvTsxBm8UogSUFJItI6gY2J2o+LZ2GnLOsW0WOPBS1YjOZIHY0nn0ff6jOw+MKzvHtURyRCEgtISv4N1TZzyAihhCf0YMXdNQ8kXescyZMw51qMWctOX4S7AdxSdoHbUCK640eGcWDgh8gl/i5cDk5SwCQgkwBJApJ9+aIIghc8qK9kxqQg5N4ScnBag+ldgPqhCdSffAH9V70fPSuSDhA0/0empq5rOC1yTJkCCdoSMbJ+l5q9sYq9EqKVSMIydUfezJ8UANQFrhmwEh/3B2Y+vO8gXt/5U1DvIjV3FVwEFsHFycQKBEZZI4AgX+Tyd4c6FZkau1AkWhAAlBdsBuQtUNaErY9i8R+fjYXnLG5zAxs1L+auZm1yv930yU6mhOdMv14QJLVQ8wTpeggtFwmMrxvUtezVwQLuDtp77Vev4NDLL4H6lqvALNpVEFIPgnEgeM1zxfwdCBx8mJwtu+zMeksQVbRAtuatKlU+Gd/1Bri1Cov+YJnrBUi6K5OMFuCSIdWstNTYqjknxnWcCE29VoRTayOXHpNN1AX0fuPyAnEFkm3mOwIA18m/o28cwaFXXgX1LvUCJs7fVXCZsHMBXYuEAk5Yl0xfKZFcfcDRLH2zU/xWJqWWIJPzn2kMJn59GLX+PvSeUXN3MfmwCr0+uIL0BRK46o89ycoqz10USo1whCRDGdhkAMIS3MUqXxjDH0i95ldNjE1i79PPgBYsVfIQplChBYQ0VW2p/wfSUyFNnCBrCHQTdiAY3/h0wARXkBxA7xdABACxpizxRGpw/IU3sHLt76HW11LyKwqoPIY+0TZ8jpDSBIxqX5aWupZ+r/E9SfZZR+6+MxHXNS55Y6Zl6bUDVouEoWeeAxYsKcxehBOhxfy9luAnqSZunD69aMHa476boL9WpkTkLcNIkbuPyGxjzg9LeESSnsl5zw1kJlejyTS66xhWXtLnk6BMBSOf3UWbEg7RwqhgfwXROugdYNJAdS4ULMXKfaoYSanzPrGAdUffPIrx8Sao1uuECsIbZ6LiCkyJ17TXLgcQUAUh7McywhOjcMGbQ1ybHPvIwQeu/2EH5QOfO/P+585lMjubwyd+p34Y6PvdpvPvEAIFLI0EkzBouAirfUF/jlslkKhwI02Js6gwm+dIElZXoLX/Pd761c9fTCcm8xjbBQAX6z0HBF8X2yEnuNNmOWUN/o9IhmGfx8ewcOgXzx58aP2lXQTvGKv+5Wf/aejEJ8+40ni2ls9p+OaoM3ttkFLDtclIkiK/rY3TFlKNFmP60eGYCC0W51rq7MAcH6+nE6NNgFIQBY2nqnHVvPohxapMtzn4EJcamVzpeoX97LU9aAx8543ZCi/jrY1X/WVWrx20TTjTFxfQ5mgGsnXHCXKScxjUfVKEUo8Aeo9zyUB+TvPBQa11BGrq9Ryo9XpCE1tK3JpEeOOJhGIjo5ugoZHRfi57cSeyF37GlPZ+aLbCh0G9Sz5YP0owPAniSR81Gu6sDZlg7gVnl+nJceu0zDbXMCn8oMLmLjzKdp7ncd7m2JERsHFEp0IbDwKcubOn+dCnm1LbQMUy8peeQf7aq6C0d/fYD+789VwBOLTx8qGeVtbkWEvUXSaICXUH9WmbOa3yRGGNXIe1LeSWY+QA+yaqtsxQFEgCQNZyWZtqXUhPCI4KAgkmH/Pu2YDw1uvIX9/tC6aeb85V+DAWLTS/FGHBTSU4eNMOcZ1UwJZrfpQsJaTNMi+bh0kXvcgQpazlEZO1rNe293PyTQf/dYWA/taZQJgYRf78j0FiVUlNssaZi/8pRp7zYxLzlQAlznPdf2fLA8Je4FZ0BzUC6xs1NvOCZt4dnEs4a9FMcH86Pl73/l6O6S6F05SRfZITqzM5VqS78mHlMGhffAqU9ACm5lPmkwcAZ/zmqaIr4X2eG15YX09Qrs8S9J+mwRlM4ouvcB25qtR1n23pfQTekjLVYgOiHMtd7PZxn3lqEPydmgW+uRcYO+40n/j6QWdzkoPtdRoBooa9X8cnyvAztX4JabET1Nk2O67QfIFDjSYj+8Z7djzq+idcVHIcutwUMruQVrSB4G3GAeTh2/NLnzGmpSW54GTlJztxo6vpWy4bFDIkhC6v4wKxCLWElj56k3jvSK541M6hP8G+DtDSXbtCSEN459D2DAUIe3LkYOptIJTNX64/ctDlpEmPN/3E84m55mSEv2zgQSnRz3XaZz8PlwtoNak9/7zoOAsA2hr3hVNS7Tlr1mhieT7yH+/doc8NDTNGok45olF6EtP21Jbbn+T6iw/sclr3CZRWkhpZzO+fnP6znQZ1Eg07Vre+CMrj06DgHqRRwvoGSu4bIqECzD3huVLY6ibfGr5F6L8e8uWA9EwgcPuxRh0YGyk6RmT8ooCmS2/+WtenMlONy3583wbixqro88r6Df/lrrESOkwIpKYC+qInMJMmQcXzB7/98CMX7IgvXQlH7A475Xg/HQjlVFdNc/Rt1zMIqbT4bQypCsJtcwGA0LrHxfhm1DbCf256Umz6OZSJj3zq66rHAJCERRGemR969I92VB6ZS0mwvdz/riQ9M4EQTo4NO8Z3Jl/WfijK1iy96Wuzf2kB+YAzX3Zmz+EZYMvrtnhCrKYdXq9BHqu/PGftAYZpE/j2bRft6HhfwNh73/9AELQdBLSB0G76AQQeHS7MHhQjSvVpL74yWwB2fuiu6wEeIh/6HAdk8fUbUl7IfamclTTNsfHq2mq6P8SWz9l20fe7vj8U0r63ZgMCIghVN6m2xUO3qNCnH/1Lb3p4YPYg3HMemG8n2CHNctTnPZ0DngPyEjcFAldTF70MMfPV2y957LzvXfz4lO8MaVfY3LlrK0Dru82bYoFfPReOaw/u6e+AehYCaa9/SpTElDpmEgWKW058+2/m/Frb2oF/3ECUX2soW07IzidkC+KrdNAXqOqEbLchfvoHV3x71p8fANC2eDdBpwXBn6z9XABYHHL/opNUzi0LAJiYP3H8v9afttdf5zJUTfafLxATGSqbfNXsUbhDlwjBi99VQqzD99uHnHxk2Y1bZ3x/5x0DAE6Ou/xWwfjoAkIHCcI1VOY2BIT1y27cOmtOOF2j8nCUNu0aJkJ/caD8uKtyKPq/jPS1F5AMvxXT4IIDurqAS7MLZCUTvfX4tr/9rbhE++PZW2P8B6axBFQiAS/sL31EOQOf1ZCbv7Xshq/uWXbDV9fOt4ArPnr/6hUfvW/riuvu63g9RkbHCxK0aZe+IFElvE5LQIkcTWMcPa8MAmnfbKJAuwVU1xL/mR8c+e6tp/Qm+PKPfWktMf+TPPh2eRCkXfS+Y098rhIS0y73fhjAPriS31eIviCmolQOhyUU2d5F4FofyMbu6Aw8OO1YA+BL/X/xlX8F+AAYAwB/feR7n35qWoE//mXR8PVgXiflhHu7rTIWdLuv66uytGmXvEfzebdTlqXa+49H5SnaoX2oHdlXWIBUhiWw5mAB/jw6LAcsTT9tErZf09/pox3XbDn2xB0d+cGU7wrTpl3PyS9eZguCyRrofWkAlC7wVWFavXF+ADjZa4aO7bjjvG5yTvmOCm++4E8A8ZvSPEo77amzTXuRrzwrvg0Sl/YL3/kxOZXw0wLgx/tmBYI/0Trzvf7FzlCKzjkizPeY9DJMOaYFgDdrhjgzCGHXJGitek/x5CYWLvhtACFf+JFjOz477Y8nZnxbvCsIFamrqXO24izkkhrbvATCO+4KMtdrju347LSRQ8asfi/QAQI6QUAJhOa7/xBWqkPfi3uHQVCzH/7+7TMKL2POvxmqRIdKalxNmKQp0bv3/2Cak/6NktAlKr9CMe9RYGj48X+YkvC6jTn/ZshHhy1R4VOkzvJ4vXHuxcj7lmqPHl0tYd6sQT5oy1yFl3HSP5ujTdpD+JHP3DBd6pwe2Y+ew/v9ixam9HsDatMunYwFDIHx4eHHP3NSvyY95R9O0qZdN/t+X/90CZOpj6P21qtIJk7AhJZSeOJSfgzVFYCwWwFAqsgvDD/296dUM8zbT2c9EPeCsGa6rDGZOI6et19HMnrUFUyMEhBxUmGjzQL0vzRu7hrZftu8lM/z/uNpdQ3C3eTePVw1XeqcjI8gPXEEpj4GakwW7yD5gsr2LQYvXIKe1GS9k6M7Jk6c2DCy/e/m7YfTOqXT/fN5c+euDQCtA+F8koqs1HDp6DVKUZU1kHKLFxk7upCbP9l379UfO22TA/D/l2/Fnh+hyh0AAAAASUVORK5CYII=",s=!!_ge("wsb_form_q"),i,e,u,r,f,a=/[\.,:;?!¿¡]/g,h=-933981677285477,v=400;t.toIcon=o;var y={"action://Help/Launch":"Help","ms-cortana://navigate/Notebook":"Notebook"},p={"ms-cortana://navigate/Settings":t.config.settingsUri},w=function(){function a(s){var c=this,a,l,v,y;this._accessTokenManager=s;this._queryParamsCache={};this._locStrings=[];this._enUsLocStrings=[];this._modifierKeyState={altKey:!1,ctrlKey:!1,shiftKey:!1};this._bootstrapDoneEventHandlers=[];this._appVisibleEventHandlers=[];this._shownEventHandlers=[];this._conversationStartEventHandlers=[];this._dismissedEventHandlers=[];this._appHiddenEventHandlers=[];this._searchBoxGotFocusEventHandlers=[];this._searchBoxLostFocusEventHandlers=[];this._onSubmitHandlers=[];this._onFeedbackClosingHandlers=[];this._onSearchBoxGlyphIconClick=[];this._onSearchBoxClick=[];this._onButtonRightOfSearchBoxClick=[];this._queryChangedHandlers=[];this._rawQueryChangedHandlers=[];this._keyDownHandlers=[];this._keyUpHandlers=[];this._keyEscapeHandlers=[];this._accessTokenAvailableHandlers=[];this._scopeListRequiresUpdate=[];this._accountChangedHandlers=[];this._pinnedApps={};this._state=0;this._paneCloseCount=0;this._qfDismissCount=0;this._defaultWindowsTheme=0;this._defaultAppTheme=0;this._currentPaneHeight=0;this._root=_ge("root");this._rootContainer=_ge("rootContainer");this._defaultBrowser=0;this.usedImpressionIds={};this.getEdgeIcon=function(n,t){var i=c._defaultBrowserIconCache&&c.getUriLaunchPolicy()==0?c._defaultBrowserIconCache:c._edgeIconCache;return i(n,t)};this._instrumentationHelper=null;this._suggestionsContainer=_ge("suggestionsList");i=SearchAppWrapper.CortanaApp;e=i.queryFormulationView;u=i.launcher;r=typeof SearchBoxController=="object"?SearchBoxController:i.searchBox;f=n.Service.QueryParams;n.refreshBingEnabledCache(i.isBingEnabled,t.getMarketForBingAvailability());this._currentCVID=n.cleanGuid(this.createGuid());this._randomPrivacyNumber=this.getNewPrivacyNumber();this.initCortanaEnabledAndRegion();this.initLanguage();this.initLocStrings();a=n.safeExecute(function(){return+e.perfMetrics.lookup(32)},"perfMetricsFallbackLookup",h);this._hasFallbackHappened=a!=h;l=e.searchHistory;l&&l.addEventListener("cleardevicehistoryrequested",function(){var t=function(t){return n.safeExecute(function(){return l.signalClearDeviceHistoryCompleted(t)},"signalClearDeviceHistoryCompleted")};c._clearStorageRequestedHandlers?n.safeExecute(function(){return c._clearStorageRequestedHandlers(t),!0},"clearDeviceHistoryRequested")||t(!1):t(!1)});i.addEventListener("statechanged",function(n){c.updateState(c._state,n.newState,!1)});r.addEventListener("querytextchanged",function(n){if(!c._qfDisabled){c._feedbackFormIsVisible&&c.closeFeedbackForm();var t=n.queryText;c._queryPropertiesOverrides&&c._queryPropertiesOverrides.query!=t&&(c._queryPropertiesOverrides=null);c.updateState(c._state,2,!0);c._queryToIgnoreOnQueryTextChangedEvent!=n.queryText&&(c._queryToIgnoreOnQueryTextChangedEvent=null);c.callQueryChangedHandlers(n,!1,c._queryToIgnoreOnQueryTextChangedEvent!=null,n.impressionId)}});r.addEventListener("keydown",function(u){var f,e,o,s,h;if(f=u.keyCode,t.config.debugDismissEvents){if(f==121){c.updateState(c._state,1,!1);return}if(f==122){e=c._state==0?2:0;e==2&&(c._currentCVID=null);c.updateState(c._state,e,!1);return}}if(c._qfDisabled){if(i.hostingEnvironment==3&&f==13){o=r.getQueryText().queryText;i.fileExplorerSuggestionPage.onSuggestionSelection(o)}return}if(f!=9&&!n.isFunctionalKey(f)){if(f==27){c.keyDownEscapeHandler();return}s={shiftKey:u.isShiftKeyPressed,ctrlKey:u.isControlKeyPressed,altKey:!1};h=u.isHandled;c._instrumentationHelper.instrumentKeyDown(n.getCurrentTime());c._keyDownHandlers.forEach(function(t){return n.safeExecute(function(){return t(f,s,h)},"keyDown")})}});sj_b.addEventListener("keydown",function(i){var r,f,s,u,e,o;if(!c._qfDisabled){if(r=i.keyCode,t.config.debugDismissEvents){if(r==121){c.updateState(c._state,1,!1);return}if(r==122){f=c._state==0?2:0;f==2&&(c._currentCVID=null);c.updateState(c._state,f,!1);return}}if(!n.isFunctionalKey(r)){if(r!=9||c._feedbackFormIsVisible||i.preventDefault(),s=t.RuntimeConfig.AlwaysWide,u=i.target,u){if(e=_ge("fbpgdg"),e&&e.contains(u))return;if(r==27){c.keyDownEscapeHandler();return}if(!s&&t.RuntimeConfig.PreviewPaneAvailable&&(o=_ge("qfPreviewPane"),o&&o.contains(u)&&(!t.DialogBox||t.DialogBox.isVisible())))if(r==37)sj_pd(i);else return}n.contains([38,40],r)&&sj_pd(i);c._keyDownHandlers.forEach(function(t){return n.safeExecute(function(){return t(i.keyCode,i,!1)},"body.keyDown")})}}});r.addEventListener("keyup",function(t){var i,r,u;c._qfDisabled||(i=t.keyCode,i==9||n.isFunctionalKey(i))||(r={shiftKey:t.isShiftKeyPressed,ctrlKey:t.isControlKeyPressed,altKey:!1},u=t.isHandled,c._keyUpHandlers.forEach(function(t){return n.safeExecute(function(){return t(i,r,u)},"keyUp")}))});sj_b.addEventListener("keyup",function(t){if(!c._qfDisabled){var i=t.keyCode;n.isFunctionalKey(i)||c._keyUpHandlers.forEach(function(r){return n.safeExecute(function(){return r(i,t,!1)},"keyUp")})}});r.addEventListener("gotfocus",function(){c._qfDisabled||c._searchBoxGotFocusEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"gotfocus")})});r.addEventListener("lostfocus",function(){c._qfDisabled||c._searchBoxLostFocusEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"lostfocus")})});r.addEventListener("submitbuttonclick",function(){if(!c._qfDisabled){var i=n.getCurrentTime(),t=c.getFeatureString("SubmitButtonGlyph").featureValue;t&&t!=""?c._onButtonRightOfSearchBoxClick.forEach(function(i){return n.safeExecute(function(){return i(t)},"submitbuttonclick.custom")}):c._onSubmitHandlers.forEach(function(t){return n.safeExecute(function(){return t(i,!0,null)},"submitbuttonclick")})}});r.addEventListener("searchboxglyphclick",function(){c._qfDisabled||c._onSearchBoxGlyphIconClick.forEach(function(t){return n.safeExecute(function(){return t()},"searchboxglyphclick")})});r.addEventListener("searchboxtapped",function(){c._qfDisabled||c._onSearchBoxClick.forEach(function(t){return n.safeExecute(function(){return t()},"searchboxtapped")})});r.addEventListener("searchboxclick",function(){c._qfDisabled||c._onSearchBoxClick.forEach(function(t){return n.safeExecute(function(){return t()},"searchboxclick")})});sj_evt.bind("ajax.feedback.initialized",sj_dm(this,this.registerFeedbackDebugCallback),!0);this.bindAppVisible(function(){return c.appVisibleInit()});this.bindShown(function(i){if(n.safeFireEvent("ajax.threshold.pageStart",i),c.shownInit(),!c._qfDisabled){var r=c.getNewConversationId();t.updateErrorHandlingCVID(r);c._currentCVID!=r&&(c._currentCVID=r,c._randomPrivacyNumber=c.getNewPrivacyNumber(),c._conversationStartEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"conversationStart")}));c._lastKeyWasEnter=!1}});this.bindDismissed(function(){c._qfDismissCount+=1;n.safeFireEvent("threshold.pageUnload");c.dismissCleanup()});this.bindAppHidden(function(){c._paneCloseCount+=1;c.appHiddenCleanup();c.uploadClientErrorLog()});this.bindKeyDown(function(t,i){var r,u;c._modifierKeyState=i;r=t==13;r&&!c._lastKeyWasEnter&&(u=n.getCurrentTime(),c._onSubmitHandlers.forEach(function(t){return n.safeExecute(function(){return t(u,!1,i)},"onSubmit handlers")}));c._lastKeyWasEnter=r});this.bindKeyUp(function(n){c._lastKeyWasEnter=!1;switch(n){case 16:c._modifierKeyState.shiftKey=!1;break;case 17:c._modifierKeyState.ctrlKey=!1}});this.bindOnFeedbackClosing(function(n){n&&c.setFocusInSearchBox(null,"onFeedbackClosing")});(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.refreshWhenTokenArrives)&&this.bindAccessTokenAvailable(function(n){var i=n==1?function(n){return n.dataSource=="SSEE"||n.dataSource=="SSUE"}:function(n){return n.dataSource=="SSEC"||n.dataSource=="SSUC"};c._currentQuery&&(c._currentQuery.queryToFetch.length>=t.config.minLengthFor3SonL1||t.isL2(c._currentQuery))&&c._currentQuery.originalQuery==r.getQueryText().queryText&&t.ScopeConfig[c._currentQuery.scope].enabledDataSources.some(i)&&c.refreshCurrentPane()});_G.PN="QF";this._edgeIconCache=t.Promise.safeChainWithGlobalCaching("edgeIcon",function(n){return e.deviceSearch.findAppsAsync(t.EdgeAppIds).then(function(i){var r=t.EdgeAppIds.map(function(n){return i[n]}).filter(function(n){return!!n})[0];return r.getImageAsync(t.getImageSizeValue(n)).then(function(n){return o(n,"edgeIcon",null,r.isImmersive?r.logoBackgroundColor:null)})})},function(n){return n+"_edgeIcon"});sj_evt.bind("onFeedbackStarting",function(n){var t=n===void 0?[undefined,undefined]:n,i=t[1];c._feedbackFormIsVisible=!0;c._feedbackFormIsOpenedByClient=i;c.adjustHeight()});sj_evt.bind("onFeedbackClosing",function(){c._feedbackFormIsVisible=!1;c.adjustHeight();c._onFeedbackClosingHandlers.forEach(function(t){return n.safeExecute(function(){return t(c._feedbackFormIsOpenedByClient)},"onFeedbackClosing handlers")})});this._accessTokenManager&&(this._accessTokenManager.bindAccessTokenAvailable(function(n){c._accessTokenAvailableHandlers.forEach(function(t){return t(n)})}),this._accessTokenManager.bindAccountTypesChanged(function(){return c.updateScopeList()}),v=function(){return!0},y=this._qfDismissCount,this._accessTokenManager.enumerateMultiAccountAuthority(v,function(){return c.initHeadersOverrides(y)}));this.initCloudSearch();(t.osSKUCache==undefined||t.osSKUCache==0)&&ThresholdUtilities.getOsSKU(function(n){switch(n){case"4":t.osSKUCache=4;break;case"48":t.osSKUCache=48;break;case"101":t.osSKUCache=101;break;case"27":t.osSKUCache=27;break;default:t.osSKUCache=0}})}return a.prototype.refreshDefaultBrowserInfo=function(){if(this._defaultBrowser=0,i.getDefaultBrowserInfo){var r=n.safeExecute(function(){return i.getDefaultBrowserInfo()},"getDefaultBrowserInfo");r&&(this._defaultBrowser=this.calculateBrowserType(r.path),this._defaultBrowserIconCache=e.deviceSearch.getIconForDefaultBrowserAsync&&this.getUriLaunchPolicy()==0&&this._defaultBrowser!=3?t.Promise.safeChainWithGlobalCaching("defaultBrowserIcon",function(n){return e.deviceSearch.getIconForDefaultBrowserAsync(t.getImageSizeValue(n),0).then(function(n){return n?o(n,"defaultBrowserIcon"):{type:0,content:l}})},function(n){return n+"_"+r.progId}):null)}i.setDefaultUriLaunchPolicy&&i.setDefaultUriLaunchPolicy(this.getUriLaunchPolicy())},a.prototype.getDefaultBrowser=function(){return this._defaultBrowser},a.prototype.getOsSKU=function(){return t.osSKUCache},a.prototype.getWindowsTheme=function(){return this._defaultWindowsTheme},a.prototype.getAppTheme=function(){return this._defaultAppTheme},a.prototype.getAccentColor=function(n){if(n===void 0&&(n=0),!Number.isInteger(n))throw"Invalid argument "+n;if(this._accentColorShades){var t=n<0?this._accentColorShades.light:this._accentColorShades.dark,i=Math.min(3,Math.abs(n));return t[i]}return this._accentColor},a.prototype.setInstrumentationHelper=function(n){this._instrumentationHelper=n},a.prototype.refreshAccentColorShades=function(){this._accentColorShades=null;var n=i.themeColors;n&&(this._accentColorShades={dark:[n.accent,n.accentDark1,n.accentDark2,n.accentDark3,],light:[n.accent,n.accentLight1,n.accentLight2,n.accentLight3,]},this._accentColorShades.dark=this._accentColorShades.dark.map(function(n){return"#"+n.substr(3)}),this._accentColorShades.light=this._accentColorShades.light.map(function(n){return"#"+n.substr(3)}))},a.prototype.calculateBrowserType=function(n){return n?n.endsWith("\\chrome.exe")?6:n.endsWith("LaunchWinApp.exe")?3:n.endsWith("firefox.exe")?5:n.endsWith("\\msedge.exe")?4:n.endsWith("Opera\\Launcher.exe")?7:n.endsWith("\\iexplore.exe")?2:0:0},a.prototype.getUriLaunchPolicy=function(){return this._defaultBrowser==4||this._defaultBrowser==3?0:2},a.prototype.getConnectedAccountInfo=function(n){return this._accessTokenManager?this._accessTokenManager.getCachedAccountInfo(n):null},a.prototype.isInternetConnectionMetered=function(){return n.safeExecute(function(){return i.networkEnvironment&&i.networkEnvironment.isMeteredConnection},"isInternetConnectionMetered",!1)},a.prototype.isInputPanelVisible=function(){return n.safeExecute(function(){return r.isInputPaneVisible},"isInputPanelVisible")},a.prototype.uploadClientErrorLog=function(){var o,u,e,t,f,r;if(i.getFlightingLogsAndDelete)for(o=n.safeExecute(function(){return i.getFlightingLogsAndDelete()},"getFlightingLogsAndDelete",""),u=0,e=o.split("\r\n");u<e.length;u++)t=e[u],t!=""&&(f=t.indexOf("|"),f<0||f+1==t.length?SharedLogHelper.LogWarning("clientError",t,"Malformed clientError data"):(r=t.substr(f+1),r.startsWith("Critical:")||r.startsWith("Error:")?SharedLogHelper.LogError("clientError",null,r):SharedLogHelper.LogWarning("clientError",null,r)))},a.prototype.registerFeedbackDebugCallback=function(n){var t=n[1].debugCollector;t.registerCollectionCallback(sj_dm(this,this.collectDebugInfo))},a.prototype.collectDebugInfo=function(){var r={},o=this._currentQuery&&this._currentQuery.originalQuery,u,f;return o&&(r.query=o),r.conversationId=this._currentCVID,r.entryPoint=i.entryPoint,r.previousExperience=e.previousExperience,n.WSB.ConstraintIndex&&(r.ciVersion=n.WSB.ConstraintIndex.currentCIVersion),t.config.snrVersion&&(r.snrVersion=t.config.snrVersion),t.osSKUCache!==undefined&&(r.ossku=t.osSKUCache.toString()),u=i.width,u&&(r.width=u.toString()),f=i.height,f&&(r.height=f.toString()),r},a.prototype.clearInitialFetchTimer=function(){this._initialFetchTimer&&(sb_ct(this._initialFetchTimer),this._initialFetchTimer=null)},a.prototype.callQueryChangedHandlers=function(t,r,u,f,e){var o,s,h;if(this._qfDisabled)throw"Not supported";(o=this.getStructuredQuery(t,null,this._currentQuery),this._rawQueryChangedHandlers.forEach(function(t){return n.safeExecute(function(){return t(o,r)},"rawQueryTextChanged")}),u||this.clearInitialFetchTimer(),f||(s=i.impressionId,this.usedImpressionIds[s]||(f=s,this.usedImpressionIds[s]=!0)),h=e&&!o.originalQuery,h||!f||f==this._currentRawImpressionId?(this._currentRawImpressionId=this.createGuid(),this._currentRawImpressionIdCreatedByTheClient=!1):(this._currentRawImpressionId=f,this._currentRawImpressionIdCreatedByTheClient=!0),u)||(this._previousQuery=this._currentQuery,this._currentQuery=o,this._queryChangedHandlers.forEach(function(t){return n.safeExecute(function(){return t(o,r)},"queryTextChanged")}))},a.prototype.getStructuredQuery=function(r,u,f){var o=r.queryText,c=r.cursorPosition,s,e,h;return u&&u.originalQuery===o&&u.originalCursorPosition===c?u:(s=this._queryPropertiesOverrides&&this._queryPropertiesOverrides.query==o,e=s&&t.isCortanaEnabledCache?this._queryPropertiesOverrides.taskFrame:null,!e&&t.isCortanaEnabledCache&&i.searchResultsView.getTaskFrame&&(h=n.safeExecute(function(){return i.searchResultsView.getTaskFrame(o)},"getTaskFrame"),h&&(e=t.parseTaskFrame(h))),!e&&f&&f.taskFrame&&f.originalQuery==o&&(e=f.taskFrame),t.parseQuery(o,c,f,e,s&&this._queryPropertiesOverrides))},a.prototype.updateState=function(u,f,e){var l=this,s,o,h,c;u!=f&&(this._state=f,u==0&&(s=n.getCurrentTime(),this._appVisibleEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"appVisible")}),this._instrumentationHelper.instrumentAppVisibleFinish(s)),f==2&&(o=n.getCurrentTime(),this._shownEventHandlers.forEach(function(t){return n.safeExecute(function(){return t(o)},"shown")}),this._instrumentationHelper.instrumentAppShownFinish(o),e||this._qfDisabled||(h=i.entryPoint=="WNSSTB",this._initialFetchTimer=n.safeSetTimeout(function(){return l.callQueryChangedHandlers(r.getQueryText(),!1,!1,null,!0)},h?t.config.initialFetchTimerDelayFromStartMenu||0:0,"initialFetch"))),u==2&&(this.clearInitialFetchTimer(),c=this._currentQuery,this._dismissedEventHandlers.forEach(function(t){return n.safeExecute(function(){return t(c)},"dismissed")})),f==0&&this._appHiddenEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"appHidden")}))},a.prototype.searchBoxHasFocus=function(){return r.hasFocus},a.prototype.initializeEvents=function(){this.updateState(this._state,i.currentState,!1)},a.prototype.bindClearMRURequested=function(n){this._clearStorageRequestedHandlers&&SharedLogHelper.LogError("bindClearMRURequested",null,new Error("Only one event handler supported"));this._clearStorageRequestedHandlers=n},a.prototype.shouldRequestEltoken=function(){return this._shouldRequestEltoken},a.prototype.getElToken=function(){return this._elToken},a.prototype.setElToken=function(n){this._elToken=n;this._shouldRequestEltoken=!1},a.prototype.sendElToken=function(){this._sendElTokenInSuggstionRequest=!0},a.prototype.canHaveSearchHistory=function(){return t.searchHistoryAllowed()},a.prototype.getInstrumentationParameters=function(n){var t=i.createStringMap?i.createStringMap():{};return _G.nclid&&(t[f.HashedMuid]=_G.nclid),t[f.FormCode]=n||this.getFormCode(),t[f.ConversationId]=this.getConversationId(),t},a.prototype.appHiddenCleanup=function(){t.Promise.clearGlobalCache();this._locStrings=[];t.cleanScopePrefixes();this.cleanTaskBarPinnedItems();t.clearPathExpansionCache();t.config.perfInstV2&&this._instrumentationHelper.instrumentConversationTimelineFinish()},a.prototype.initCloudSearch=function(){t.isCloudSearchEnabledCache=i.isCloudSearchEnabled!==!1;t.isMultiAccountCloudSearchSupportedCache=i.isMultiAccountCloudSearchSupported!==!1;t.isCloudSearchEnabledMsaCache=t.RuntimeConfig.QfMode==5||(t.isMultiAccountCloudSearchSupportedCache?i.isCloudSearchEnabledForMSA!==!1:t.isCloudSearchEnabledCache);t.isCloudSearchEnabledAadCache=t.RuntimeConfig.QfMode==5||(t.isMultiAccountCloudSearchSupportedCache?i.isCloudSearchEnabledForAAD!==!1:t.isCloudSearchEnabledCache)},a.prototype.initLanguage=function(){t.uiLanguageCache=(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.setLang)||i.systemLanguage||i.uiLanguage||"";this._queryParamsCache[n.Service.QueryParams.SetLang]=t.uiLanguageCache},a.prototype.initLocStrings=function(){var i,r,f;var e=this._enUsLocStrings.length==0,o=function(i){var r={uiCulture:"en-US",name:i,namespace:"WindowsSearchBox"},f;e&&u._enUsLocStrings.push(LocStringManager.getLocString(r));t.uiLanguageCache.toLowerCase()!="en-us"&&(r.uiCulture=t.uiLanguageCache,f=n.safeExecute(function(){return LocStringManager.getLocString(r)},"getLocString",null,r.uiCulture),f&&u._locStrings.push(f))},u=this;for(i=0,r=t.config.locStrings;i<r.length;i++)f=r[i],o(f)},a.prototype.appVisibleInit=function(){var r=this,u;this.initCortanaEnabledAndRegion();u=t.uiLanguageCache;this.initLanguage();t.config.noLocStringRefresh&&u!=t.uiLanguageCache?this.initLocStrings():t.config.noLocStringRefresh||this.initLocStrings();n.refreshBingEnabledCache(i.isBingEnabled,t.getMarketForBingAvailability());t.RuntimeConfig.OnAppVisible(this);this._isFileExplorerOrControlPanel=t.RuntimeConfig.QfMode==5||t.RuntimeConfig.QfMode==9;t.setZeroInputDataSourcesForL1();this.initCloudSearch();this.checkIfBitmapInClipboardSupported();this.updateScopeList();this._suggestionsContainer.setAttribute("aria-label",this.getLocString("ResultsList"));this._elToken=null;i.theme&&(this._defaultWindowsTheme=this._isFileExplorerOrControlPanel&&i.fileExplorerSuggestionPage?i.fileExplorerSuggestionPage.useDarkTheme?2:1:i.theme.startsWith("000000")?2:1,this._accentColor="#"+i.theme.substr(7),i.appsUseLightTheme!==null&&(this._defaultAppTheme=i.appsUseLightTheme?1:2));this.refreshAccentColorShades();this.refreshDefaultBrowserInfo();ThresholdUtilities.setBodyLangAttributes(t.uiLanguageCache);ThresholdUtilities.getCortanaHeaders(function(n){r._ageAccountType=0;n&&(n["X-UserAgeClass"]==="Child"?r._ageAccountType=1:n["X-UserAgeClass"]==="Adult"&&(r._ageAccountType=2))})},a.prototype.shownInit=function(){var r=this,u=this._qfDismissCount,e,s,o,c,h;if(this._queryPropertiesOverrides=null,t.RuntimeConfig.QfMode==999999||t.config.enableSnipSearchV2&&i.entryPoint=="WNSSBS"){this._qfDisabled=!0;return}t.RuntimeConfig.QfMode==5&&(e=n.safeExecute(function(){return i.fileExplorerSuggestionPage.currentLocation},"fileExplorerSuggestionPage.currentLocation"),this._fileExplorerCurrentPath=e&&!e.startsWith("::")?e:null);this.initCortanaEnabledAndRegion();s=i.isBingEnabled;s!=n.isBingEnabled()&&(n.refreshBingEnabledCache(s,t.getMarketForBingAvailability()),this.updateScopeList());o=i.homeGeographicRegion;this._queryParamsCache[f.CountryCode]=t.regionCache;o&&o!=t.regionCache&&(this._queryParamsCache[f.HomeGeographicRegion]=o);t.isCortanaEnabledCache&&i.getVcdKeywordsAsync&&t.Promise.safeChain("vcdKeywords",function(){return i.getVcdKeywordsAsync()},function(n){u==r._qfDismissCount&&(r._vcdKeywords=n)});this._accessTokenManager&&(c=function(){return u==r._qfDismissCount},this._accessTokenManager.enumerateMultiAccountAuthority(c,function(){return r.initHeadersOverrides(u)}));this.initHeadersOverrides(u);this.keepWSBOpen(t.config.keepCortanaOpened||t.getTweakedSetting("keepCortanaOpenedTweak"));t.RuntimeConfig.QfMode==8&&(h=function(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+n+"=([^&#]*)"),t=i.exec(_w.location.search);return t===null?"":decodeURIComponent(t[1].replace(/\+/g," "))},this._queryParamsCache[f.Host]=h("host"),this._queryParamsCache[f.CortanaVersion]=h("version"))},a.prototype.initCortanaEnabledAndRegion=function(){t.isCortanaEnabledCache=i.isCortanaEnabled;t.regionCache=(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.cc)||(t.config.ignoreCortanaMarketOverride?i.homeGeographicRegion:i.region)||"";t.revIpRegionCache=typeof _G=="object"&&_G.RevIpCC&&_G.RevIpCC.toUpperCase()||""},a.prototype.updateScopeList=function(){this._scopeListRequiresUpdate.forEach(function(n){return n()})},a.prototype.dismissCleanup=function(){this.keepWSBOpen(!1);delete this._queryParamsCache[f.HomeGeographicRegion];this._queryToIgnoreOnQueryTextChangedEvent=null;this._currentQuery=null;this._queryPropertiesOverrides=null;this._vcdKeywords=null;this._fileExplorerCurrentPath=null;t.regionCache=null;this.closeFeedbackForm();this.removeFeedbackForm();this._qfDisabled=!1},a.prototype.closeFeedbackForm=function(){n.safeFireEvent("WindowsFeedback.Form.Hide")},a.prototype.removeFeedbackForm=function(){typeof WindowsFeedbackForm!="undefined"&&WindowsFeedbackForm.Remove&&WindowsFeedbackForm.Remove()},a.prototype.checkIfBitmapInClipboardSupported=function(){if(i.getClipboardAvailableFormats)try{var n=i.getClipboardAvailableFormats();this._isBitmapInClipboardSupported=n!=null}catch(t){this._isBitmapInClipboardSupported=!1}else this._isBitmapInClipboardSupported=!1},a.prototype.isBitmapInClipboardSupported=function(){return this._isBitmapInClipboardSupported},a.prototype.getBitmapURIFromClipboardAsync=function(r){var u=n.safeExecute(function(){return i.getClipboardAvailableFormats()},"getClipboardAvailableFormats",[]);n.contains(u,"Bitmap")||r(null);t.Promise.safeChain("getClipboardBitmapAsync",function(){return i.getClipboardBitmapAsync()},function(n){return r(URL.createObjectURL(n))},function(){return r(null)})},a.prototype.setAuthHeadersFromWindowsTokens=function(){var n,i,r,u;this._accessTokenManager&&(n=this._headersCache,i=t.AccessTokenManager.getWindowsAccountType(),t.config.userProfileButtonEnabled?(r=this._accessTokenManager.getSelectedAccountInfo(),r&&(u=r.accountProviderAuthority=="consumers"?0:1,this._accessTokenManager.getAccountByUserName(!1,u,r.accountUserName,!1,!0,function(t){t&&t.Token&&(u==0?n["X-Search-RPSToken"]=t.Token:n.Authorization="Bearer "+t.Token)}))):i==2||i==4?this._accessTokenManager.getAccount(0,t.getBingResourceOrScope(0),!1,!0,function(t){t&&t.Token&&(n["X-Search-RPSToken"]=t.Token)}):i==1&&this._accessTokenManager.getAccount(1,t.getBingResourceOrScope(1),!1,!0,function(t){t&&t.Token&&(n.Authorization="Bearer "+t.Token)}))},a.prototype.initHeadersOverrides=function(n){var r=this,u=[];this._headersCache={};i.systemRAMInMB&&i.systemRAMInMB<=512&&u.push("LowMemoryDevice");u.push("FontV22");u.push("LightAnswers");t.RuntimeConfig.PreviewPaneAvailable&&u.push("PreviewPaneAvailable");u.length>0&&(this._headersCache["X-BM-ClientFeatures"]=u.join());this.setAuthHeadersFromWindowsTokens();ThresholdUtilities.getCortanaHeaders(function(i){if(i&&n==r._qfDismissCount){r._shouldRequestEltoken=!!i["X-Search-Location"];var f=i["X-BM-ClientFeatures"];f&&(Array.prototype.push.apply(u,f.split(",")),r._headersCache["X-BM-ClientFeatures"]=u.join());r._safeSearchSetting=i["X-Search-SafeSearch"];r._isEducationEnvironment=i["X-Device-EnableRegulatoryPsm"]=="1";r._isWindowsS=i["X-Device-EnableCPsm"]=="1";r._partnerSearchCode=i["X-Device-PSC"];t.substrateProvidersEnabled()||r.updateScopeList()}})},a.prototype.createGuid=function(){return n.safeExecute(function(){return i.createGuid()},"createGuid","")},a.prototype.getLocString=function(t){for(var i,u,e,o,f=[],r=1;r<arguments.length;r++)f[r-1]=arguments[r];for(u=0,e=this._locStrings;u<e.length;u++)if(o=e[u],i=o[t],i)break;return i||(i=this.getEnUsLocString(t)),i&&f.length>0&&(i=n.formatString(i,f)),i},a.prototype.getEnUsLocString=function(n){for(var u,r,t=0,i=this._enUsLocStrings;t<i.length;t++)if(u=i[t],r=u[n],r)return r;return undefined},a.prototype.getRawImpressionGuid=function(){return this._currentRawImpressionId},a.prototype.getConversationId=function(){return this._currentCVID},a.prototype.getPrivacyNumber=function(){return this._randomPrivacyNumber},a.prototype.getNewConversationId=function(){var t=n.cleanGuid(n.safeExecute(function(){return e.perfMetrics.conversationId},"conversationId"));return t||(SharedLogHelper.LogWarning("getNewConversationId",null,new Error("Client returned null conversation ID")),t=n.cleanGuid(this.createGuid())),t},a.prototype.getNewPrivacyNumber=function(){return Math.floor(Math.random()*Number.MAX_VALUE)},a.prototype.keyDownEscapeHandler=function(){var t={handled:!1};this._keyEscapeHandlers.forEach(function(i){return n.safeExecute(function(){return i(t)},"escapeKey")});t.handled||n.safeExecute(function(){return SearchAppWrapper.CortanaApp.dismissApp()},"dismissApp");return},a.prototype.bindQueryChangedOrInitialized=function(n,t){t?this._rawQueryChangedHandlers.push(n):this._queryChangedHandlers.push(n)},a.prototype.bindOnSubmit=function(n){this._onSubmitHandlers.push(n)},a.prototype.bindOnFeedbackClosing=function(n){this._onFeedbackClosingHandlers.push(n)},a.prototype.bindSearchBoxGlyphIconClick=function(n){this._onSearchBoxGlyphIconClick.push(n)},a.prototype.bindSearchBoxClick=function(n){this._onSearchBoxClick.push(n)},a.prototype.bindButtonRightOfSearchBoxClick=function(n){this._onButtonRightOfSearchBoxClick.push(n)},a.prototype.bindSearchBoxGotFocus=function(n){this._searchBoxGotFocusEventHandlers.push(n)},a.prototype.bindSearchBoxLostFocus=function(n){this._searchBoxLostFocusEventHandlers.push(n)},a.prototype.getModifierKeyState=function(){return this._modifierKeyState},a.prototype.notifyBootstrapDone=function(){this._bootstrapDoneEventHandlers.forEach(function(n){return n()})},a.prototype.bindBootstrapDone=function(n){this._bootstrapDoneEventHandlers.push(n)},a.prototype.bindAppVisible=function(n){this._appVisibleEventHandlers.push(n)},a.prototype.bindShown=function(n){this._shownEventHandlers.push(n)},a.prototype.bindConversationStart=function(n){this._conversationStartEventHandlers.push(n)},a.prototype.bindDismissed=function(n){this._dismissedEventHandlers.push(n)},a.prototype.bindAppHidden=function(n){this._appHiddenEventHandlers.push(n)},a.prototype.bindKeyEscape=function(n){this._keyEscapeHandlers.push(n)},a.prototype.bindKeyDown=function(n){this._keyDownHandlers.push(n)},a.prototype.bindKeyUp=function(n){this._keyUpHandlers.push(n)},a.prototype.bindAccessTokenAvailable=function(n){this._accessTokenAvailableHandlers.push(n)},a.prototype.bindScopeListRequiresUpdate=function(n){this._scopeListRequiresUpdate.push(n)},a.prototype.bindAccountChanged=function(n){this._accountChangedHandlers.push(n)},a.prototype.getQuery=function(){return this.getStructuredQuery(r.getQueryText(),this._currentQuery,this._previousQuery)},a.prototype.refreshCurrentPane=function(){var n=this._currentQuery?this._currentQuery.originalQuery:"";this.setQuery(n,!1,!0)},a.prototype.keepWSBOpen=function(n){var t=i.hostingEnvironment==3;!t&&i.changeExplicitDismissMode&&i.changeExplicitDismissMode(n)},a.prototype.notifyAccountSelected=function(n){this.setAuthHeadersFromWindowsTokens();this.refreshCurrentPane();this._accountChangedHandlers.forEach(function(t){return t(n)})},a.prototype.updateQueryWithoutRefetching=function(n){t.isNullOrUndefined(n)&&(n=this._currentQuery?this._currentQuery.originalQuery:"");this.setQuery(n,!1,!1)},a.prototype.reformulate=function(n,t,i,r){var u={query:n,taskFrame:t,topHitRestriction:i,forceGroupOnTop:r};this.setQuery(n||"",!0,!1,u)},a.prototype.reformulateOnSuggestionClick=function(n,t,i,r){var u={query:n,fromSearchHome:t,fromSuggestionType:i,inorganic:!0,serpURLParams:r};this.setQuery(n||"",!0,!1,u)},a.prototype.setQuery=function(u,f,e,o){var s=this,h,c,l,a;if(t.isNullOrUndefined(u))throw new Error("query parameter can't be null");if(!f&&o)throw new Error("Property overrides only allowed on query reformulations");h=!f&&!e;this._queryPropertiesOverrides=o;h&&(this._queryToIgnoreOnQueryTextChangedEvent=u);c=!!t.config.setQueryKeyboardNavParamAvailable&&h&&r.getQueryText().queryText!=u;n.safeExecute(function(){return r.setQueryText(u,f,s._currentRawImpressionIdCreatedByTheClient?s._currentRawImpressionId:i.impressionId,c)},"setQueryText");l=f&&this.getQuery().originalQuery==u||e;l&&(a=function(){return s.callQueryChangedHandlers({queryText:u,cursorPosition:u.length},e,!1)},n.safeExecute(a,"triggerQueryTextChangedEvent"))},a.prototype.setAutoCompleteQueryText=function(t){var i=this;n.safeExecute(function(){return r.setAutoCompleteQueryText(t,i._currentRawImpressionId)},"setAutoCompleteQueryText")},a.prototype.manuallyDismissApp=function(){t.config.manuallyDismissApp&&SearchAppWrapper.CortanaApp.dismissApp()},a.prototype.launchUri=function(n,i,r,f){var e=this,o=function(n){n?(r&&r(),e.manuallyDismissApp()):f&&f()};t.Promise.safeChain("launchUri",function(){var t=u.createUriLaunchOptions();return t.launchPolicy=e.getUriLaunchPolicy(),t.dismissAppBeforeLaunchingURI=i,u.launchUriAsync(n,t)},o,f)},a.prototype.launchOutlook=function(n,i,r){var f=this;t.Promise.safeChain("launchOutlook",function(){return u.launchEmailInOutlookNativeAsync(n)},function(n){n?(i&&i(),f.manuallyDismissApp()):r&&r()},r)},a.prototype.submitFileExplorerTextSuggestion=function(t){n.safeExecute(function(){return i.fileExplorerSuggestionPage.onSuggestionSelection(t)},"submitFileExplorerTextSuggestion")},a.prototype.submitFileExplorerFolderSuggestion=function(t){n.safeExecute(function(){return i.fileExplorerSuggestionPage.onFolderSelection(t)},"submitFileExplorerFolderSuggestion")},a.prototype.removeItemFromPinnedToTaskbar=function(n){this._pinnedApps[n]=!1},a.prototype.addItemToPinnedToTaskbar=function(n){this._pinnedApps[n]=!0},a.prototype.cleanTaskBarPinnedItems=function(){this._pinnedApps={}},a.prototype.isPinnedToTaskbar=function(n){return this._pinnedApps[n]},a.prototype.launchSearchInFileExplorer=function(t){i.launcher.launchExplorerSearch?n.safeExecute(function(){return i.launcher.launchExplorerSearch("query="+n.encodeURIComponentForWindowsProtocol(t)+"&crumb=kind:docs&crumb=location:")},"launchExplorerSearch"):n.safeExecute(function(){return i.launcher.launchSearchInApp(1,t)},"launchSearchInApp")},a.prototype.matchesVcd=function(n){var t,r,i,u,f,e;if(this._vcdKeywords&&n&&(t=c(n),t))for(r in this._vcdKeywords)if(this._vcdKeywords.hasOwnProperty(r)&&(i=c(r),i&&(u=t.indexOf(i),u>=0&&((f=this._vcdKeywords[r],f&1)||f&2&&u==0||f&4&&(u==t.length-i.length||(e=t.lastIndexOf(i),e==t.length-i.length))))))return!0;return!1},a.prototype.isRequestFocusAvailable=function(){return!!r.requestFocus},a.prototype.setFocusInSearchBox=function(t,i){var u,f,e;this.isRequestFocusAvailable()&&(u=function(){return r.requestFocus()},f="requestFocus",t==9?n.safeSetTimeout(u,0,f,i):n.safeExecute(u,f,null,i),e=n.getCurrentActiveElement(),e&&e.blur())},a.prototype.setFocusInWebView=function(t){i.focusWebView&&n.safeExecute(function(){return i.focusWebView()},"focusWebView",null,t)},a.prototype.getFeatureEnabled=function(t){var r={validFeature:!1,featureEnabled:!1};return i.getFeatureEnabled?n.safeExecute(function(){return i.getFeatureEnabled(t)},"getFeatureEnabled",r,t):r},a.prototype.getFeatureDWORD=function(t){var r={validFeature:!1,featureValue:0};return i.getFeatureDWORD?n.safeExecute(function(){return i.getFeatureDWORD(t)},"getFeatureDWORD",r,t):r},a.prototype.getFeatureString=function(t){var r={validFeature:!1,featureValue:""};return i.getFeatureString?n.safeExecute(function(){return i.getFeatureString(t)},"getFeatureString",r,t):r},a.prototype.launchInApp=function(t,i,r){this.updateQueryWithoutRefetching(i);n.safeExecute(r,t)},a.prototype.launchVoiceFlow=function(n){var t=this;this.launchInApp("launchVoiceFlow",n,function(){return u.launchRAFAsync(n,t.getFormCode(),t.getInstrumentationParameters())})},a.prototype.launchSearch=function(n,i,r){r&&!t.config.disableRAF?this.launchVoiceFlow(n):this.launchUri(i)},a.prototype.launchCat1=function(n,t,r){var o=this,f=y[t],e;f?this.launchInApp("launch"+f,n,function(){return i.launchExperienceByName(f,null)}):(e=p[t],e?this.launchUri(e):this.launchInApp("launchCat1",n,function(){return u.launchCat1Async(n,r,o.getInstrumentationParameters())}))},a.prototype.launchCat2or3a=function(n,t){var i=this;this.launchInApp("launchCat2",n,function(){return u.launchCat2Async(n,i.getFormCode(),t,i.getInstrumentationParameters())})},a.prototype.launchStoreSearch=function(i){var r="ms-windows-store:search?query="+n.encodeQueryParameter(i)+"&ocid="+n.encodeQueryParameter(t.config.storeHandoffTag)+"&type=apps";this.launchUri(r)},a.prototype.launchFolder=function(t){n.safeExecute(function(){return u.startLaunchFolder(t)},"launchFolder")},a.prototype.launchWindowsCortanaSettings=function(){this.launchUri("ms-settings:cortana")},a.prototype.launchWindowsIndexingOptions=function(){t.LocalDataProvider.launchIndexingOptions(this,!1)},a.prototype.launchCortanaSignIn=function(){this.launchUri("ms-cortana://CapabilitiesPrompt/?RequestedCapabilities=Personalization")},a.prototype.launchCortanaNotebook=function(){this.launchUri("ms-cortana://StartMode=Notebook")},a.prototype.launchCortanaDevices=function(){this.launchUri("ms-cortana://StartMode=Devices")},a.prototype.launchWindowsAccountSettings=function(){this.launchUri("ms-settings:emailandaccounts")},a.prototype.launchSearchSettings=function(){this.launchUri("ms-settings:cortana-windowssearch")},a.prototype.launchSearchDetails=function(){this.launchUri("ms-settings:search-moredetails")},a.prototype.launchSearchPermissions=function(){this.launchUri("ms-settings:search-permissions")},a.prototype.launchLockscreenSettings=function(){this.launchUri("ms-settings:personalization-lockscreen")},a.prototype.launchDeviceItem=function(r,f){var s=this,e=r.id,o=f,h,c;t.localDataSourceMayContainPII(f)||(o+="\n"+e);e.startsWith("shell:")?n.safeExecute(function(){return u.startLaunchFolder(e)},"launchDeviceItem",null,o):(h=function(){if(s._isFileExplorerOrControlPanel)i.fileExplorerSuggestionPage.onFileSelection(r);else s.manuallyDismissApp()},c=r.originalDeviceItem||r,t.Promise.safeChain("launchDeviceItem",function(){return u.launchSearchItemAsync(c)},h,null,null,o,0))},a.prototype.launchAppItem=function(i,r,f){var h=this,e=i.id,o=r+"\n"+e,s;f&&o+"\n"+f;e.startsWith("shell:")?n.safeExecute(function(){return u.startLaunchFolder(e)},"launchAppItem",null,o):(s=i.originalDeviceItem||i,t.Promise.safeChain("launchAppItem",function(){var n;return f&&(n=u.createAppLaunchOptions(),n.appContext=f),u.launchSearchItemAsync(s,n)},function(){return h.manuallyDismissApp()},null,null,o,0))},a.prototype.launchWebContent=function(n,t,i){this.launchInApp("launchWebContent",t,function(){var t=u.createWebContentLaunchOptions();t.uri=n;i&&t.setAuthorization("Bearer",i);u.launchWebContent(t)})},a.prototype.launchPrivacyPortal=function(){this.launchUri("https://go.microsoft.com/fwlink/?LinkId=780764")},a.prototype.getCustomUrlParameters=function(i){var r=Object.assign({},this._queryParamsCache),u=i.scope;return u==t.Scope.All?delete r[f.Scope]:r[f.Scope]=t.Scope[u].toLowerCase(),t.searchHistoryAllowed()||(r[n.Service.QueryParams.NoHistory]="1"),this._sendElTokenInSuggstionRequest&&(r[n.Service.QueryParams.ElTokenValue]=this._elToken),t.RuntimeConfig.QfMode&&(r[n.Service.QueryParams.QfMode]=t.RuntimeConfig.QfMode.toString()),r},a.prototype.getCustomHeaders=function(n){var i=Object.assign({},this._headersCache),r;return n&&n.scope==t.Scope.Apps||(r=(i["X-BM-ClientFeatures"]||"").split(","),r.push("RevStore"),i["X-BM-ClientFeatures"]=r.join()),i},a.prototype.reloadWebView=function(){t.Promise.safeChain("reloadWebViewAsync",function(){return i.reloadWebViewAsync()})},a.prototype.throwIfResourcesMissing=function(){var t=_ge("cssCanary"),n=_w.getComputedStyle(t).fontFamily;if(n!="CANARY"&&n!='"CANARY"')throw new Error("Missing CSS Bundle");},a.prototype.getFormCode=function(){switch(t.RuntimeConfig.QfMode){case 6:return"WNSALK";case 8:return"W10XLS";default:return"WNSGPH"}},a.prototype.getRegion=function(){return t.regionCache},a.prototype.getLanguage=function(){return t.uiLanguageCache},a.prototype.dataSourceDependencies=function(n){return n=="Web"?["OSTMA","QS"]:[]},a.prototype.getPaneCloseCount=function(){return this._paneCloseCount},a.prototype.hasFallbackHappened=function(){return this._hasFallbackHappened},a.prototype.getSafeSearchSetting=function(){return this._safeSearchSetting},a.prototype.isEducationEnvironment=function(){return this._isEducationEnvironment},a.prototype.isWindowsS=function(){return this._isWindowsS},a.prototype.getPartnerSearchCode=function(){return this._partnerSearchCode},a.prototype.getAgeAccountType=function(){return this._ageAccountType},a.prototype.getMSNRefIg=function(){return null},a.prototype.setSearchBoxGlyphIcon=function(t){var i,u,f;r.setSearchBoxGlyphIcon&&(t?(i=t.content||"",i.startsWith("&#x")&&(u=parseInt(i.substr(3),16),i=u?String.fromCharCode(u):""),f=t.type==2?"/Assets/Fonts/CortMDL2.ttf#Cortana MDL2 Assets":"",n.safeExecute(function(){return r.setSearchBoxGlyphIcon(i,f)},"setSearchBoxGlyphIcon custom")):n.safeExecute(function(){return r.setSearchBoxGlyphIcon("","")},"setSearchBoxGlyphIcon default"))},a.prototype.adjustHeightWithoffset=function(){},a.prototype.adjustHeight=function(){var f=this,r,u;t.RuntimeConfig.PanelCanResize&&i.setWebViewHeight&&(this._pendingAdjustHeightTimer&&(sb_ct(this._pendingAdjustHeightTimer),this._pendingAdjustHeightTimer=null),(n.MockUrlParameters===null||n.MockUrlParameters===void 0?void 0:n.MockUrlParameters.clientVersion)&&(s?this._rootContainer.style.height="auto":this._root.style.height="auto"),r=this._feedbackFormIsVisible?v:this._root.offsetHeight,s&&(r+=36),u=function(){r*=i.textScaleFactor||1;i.setWebViewHeight(r);f._currentPaneHeight=r;f._pendingAdjustHeightTimer=null},!t.config.paneResizeDelay||r>=this._currentPaneHeight?u():this._pendingAdjustHeightTimer=n.safeSetTimeout(u,t.config.paneResizeDelay,"adjustHeight"))},a.prototype.isClientLocationAvailable=function(){return this._shouldRequestEltoken||!!this._elToken},a.prototype.getFileExplorerCurrentPath=function(){if(t.RuntimeConfig.QfMode!=5)throw"Not supported";return this._fileExplorerCurrentPath},a}();t.Host=w})(t=n.WSB||(n.WSB={}))})(AutoSuggest||(AutoSuggest={}))